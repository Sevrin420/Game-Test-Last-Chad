<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Last Chad Adventure - Survive the Robot Invasion</title>
    <style>
        body { font-family: 'Courier New', monospace; background: #0a0a0a; color: #00ff00; margin: 0; padding: 20px; max-width: 900px; margin: auto; line-height: 1.6; font-size: 1.15em; }
        h1, h2 { color: #ff6600; text-align: center; }
        #stats { background: #111; padding: 18px; border: 2px solid #00ff00; margin-bottom: 25px; border-radius: 10px; }
        button { background: #ff6600; color: #000; border: none; padding: 16px 32px; margin: 12px 8px; cursor: pointer; font-family: inherit; font-weight: bold; font-size: 1.2em; border-radius: 8px; min-width: 240px; touch-action: manipulation; }
        button:hover { background: #ff8800; }
        .outcome { margin: 25px 0; padding: 18px; border-left: 5px solid #ff6600; background: #111; border-radius: 8px; }
        .success { border-left-color: #00ff00; }
        .failure { border-left-color: #ff0000; }
        .roll-result { font-size: 1.4em; font-weight: bold; }
        #victory, #game-over { text-align: center; font-size: 2em; padding: 40px 20px; }
        #start-screen { text-align: center; margin: 80px 0; }
    </style>
</head>
<body>
    <h1>üî• LAST CHAD ADVENTURE üî•</h1>
    <p style="text-align: center;">Blue robot women with red glowing eyes are wiping out the island. You are the Last Chad. Survive. Gather. Fight back.</p>
    
    <div id="stats">
        <h2>Your Chad Stats</h2>
        <div id="stat-display">Waiting to start...</div>
    </div>
    
    <div id="game-container">
        <div id="start-screen">
            <button onclick="startGame()" style="font-size:1.8em; padding:35px 70px;">
                START ADVENTURE<br>Enter Your Stats
            </button>
            <p style="margin-top:25px; color:#aaa; font-size:1em;">Tap to begin (mobile fix)</p>
        </div>
    </div>

    <script>
        let gameState = {
            stats: null,
            currentNode: 'start',
            rolls: [],
            resources: 0,
            robotsDefeated: 0
        };

        const adventureNodes = {
            start: {
                text: `You awaken in the rubble of Hawaiian Paradise Park. Smoke rises from the small city nearby. Laser fire and screams echo. Your home is gone, but you're alive.

You find 3 rations in your backpack (resources +3).

What do you do?`,
                choices: [
                    { text: "Head to the city to fight robots", next: "city_fight" },
                    { text: "Search the jungle for survivors", next: "jungle_search" }
                ]
            },
            // ... (all other nodes are unchanged from previous version - omitted for brevity, but include them from your last working copy or previous message)
            // Make sure to copy ALL nodes (city_fight, city_win, etc., up to victory and game_over)
            victory: {
                text: `<div id="victory" style="color:#00ff00;">
üèÜ VICTORY! üèÜ<br>
Queen destroyed ‚Äî robots power down. Island saved.<br><br>
Resources: <span id="final-resources"></span><br>
Robots Defeated: <span id="final-defeated"></span><br>
Rolls Won: <span id="rolls-won"></span>/5
</div>`,
                choices: []
            },
            game_over: {
                text: `<div id="game-over" style="color:#ff0000;">
üíÄ GAME OVER üíÄ<br>
Vaporized by the Queen.<br><br>
Resources: <span id="final-resources"></span><br>
Robots Defeated: <span id="final-defeated"></span><br>
Rolls Won: <span id="rolls-won"></span>/5<br>
<strong>Mint another Chad ‚Äî try again!</strong>
</div>`,
                choices: []
            }
            // Add the missing nodes here if not already present
        };

        function rollD20() {
            return Math.floor(Math.random() * 20) + 1;
        }

        function displayNode() {
            const node = adventureNodes[gameState.currentNode];
            const container = document.getElementById('game-container');

            let html = `<div style="background:#111; padding:25px; border:2px solid #ff6600; border-radius:10px; margin-bottom:25px;">
                <p>${node.text}</p>`;

            if (node.choices.length === 0) {
                setTimeout(() => {
                    document.getElementById('final-resources').textContent = gameState.resources;
                    document.getElementById('final-defeated').textContent = gameState.robotsDefeated;
                    document.getElementById('rolls-won').textContent = gameState.rolls.filter(r => r.success).length;
                }, 100);
                container.innerHTML = html + '</div>';
                return;
            }

            html += '<div style="text-align:center;">';
            // FIXED LINE - backticks required here
            node.choices.forEach(choice => {
                html += `<button onclick="makeChoice('\( {choice.next || ''}', ' \){choice.action || ''}', '${choice.rollType || ''}', \( {choice.bonus || 0})"> \){choice.text}</button><br>`;
            });
            html += '</div></div>';

            container.innerHTML = html;
        }

        function makeChoice(next, action, rollType, bonus = 0) {
            if (action && action.startsWith('roll_')) {
                const isFinal = rollType === 'final';
                const mod = isFinal ? Math.floor((gameState.stats.strength + gameState.stats.dexterity) / 2) : gameState.stats[rollType];
                const totalBonus = mod + (bonus || 0);
                const roll = rollD20();
                const total = roll + totalBonus;
                const dc = adventureNodes[gameState.currentNode].dc;
                const success = total >= dc;

                gameState.rolls.push({ roll, mod, total, success, dc });

                const outcomeClass = success ? 'success' : 'failure';
                const outcomeText = success ? 'SUCCESS!' : 'FAILURE!';
                if (success) {
                    gameState.resources += 2;
                    gameState.robotsDefeated += 1;
                } else {
                    gameState.resources = Math.max(0, gameState.resources - 1);
                }

                const rollHtml = `<div class="outcome ${outcomeClass}">
                    <span class="roll-result">üé≤ Roll: ${roll} + ${totalBonus} = ${total} vs DC ${dc} ‚Üí ${outcomeText}</span><br>
                    <strong>\( {rollType.toUpperCase()} used ( \){mod})</strong>
                </div>`;

                document.getElementById('game-container').innerHTML += rollHtml;

                setTimeout(() => {
                    gameState.currentNode = success ? (adventureNodes[gameState.currentNode].nextSuccess || next) : (adventureNodes[gameState.currentNode].nextFail || next);
                    displayNode();
                    updateStats();
                }, 1800);
            } else {
                if (next) gameState.currentNode = next;
                displayNode();
                updateStats();
            }
        }

        function updateStats() {
            const display = document.getElementById('stat-display');
            if (!gameState.stats) return;
            display.innerHTML = `
                Strength: ${gameState.stats.strength} | Intelligence: ${gameState.stats.intelligence}<br>
                Dexterity: ${gameState.stats.dexterity} | Charisma: ${gameState.stats.charisma}<br>
                <strong>Resources: ${gameState.resources} | Robots Defeated: ${gameState.robotsDefeated}</strong>
            `;
        }

        function startGame() {
            document.getElementById('start-screen').style.display = 'none';
            initGame();
        }

        function initGame() {
            let s = prompt("Enter Strength (0-10):") || "3";
            let i = prompt("Enter Intelligence (0-10):") || "2";
            let d = prompt("Enter Dexterity (0-10):") || "3";
            let c = prompt("Enter Charisma (0-10):") || "2";

            gameState.stats = {
                strength: parseInt(s) || 3,
                intelligence: parseInt(i) || 2,
                dexterity: parseInt(d) || 3,
                charisma: parseInt(c) || 2
            };
            gameState.resources = 3;

            updateStats();
            displayNode();
        }

        setTimeout(() => {
            if (!gameState.stats) {
                gameState.stats = { strength:5, intelligence:4, dexterity:5, charisma:4 };
                gameState.resources = 3;
                updateStats();
                displayNode();
                alert("Browser blocked prompts - using default stats.");
            }
        }, 10000);
    </script>
</body>
</html>
